<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="France-IOI">
        
        <link rel="shortcut icon" href="../img/favicon.ico">

	<title>Troubleshooting - GraderQueue</title>

        <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../css/highlight.css">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="..">GraderQueue</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="..">Home</a>
                    </li>
                
                
                
                    <li class="active">
                        <a href="./">Troubleshooting</a>
                    </li>
                
                
                </ul>
            

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                
                    <li >
                        <a rel="next" href="..">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li class="disabled">
                        <a rel="prev" >
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                
                
                    <li>
                        <a href="https://github.com/France-ioi/graderqueue/">
                            
                                <i class="fa fa-github"></i>
                            
                            GitHub
                        </a>
                    </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#troubleshooting">Troubleshooting</a></li>
        
            <li><a href="#tasks-accumulating-in-queue">Tasks accumulating in queue</a></li>
        
            <li><a href="#servers">Servers</a></li>
        
    
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="troubleshooting">Troubleshooting</h1>
<p>If the grader queue stops working, here are a few steps to try and find the issue.</p>
<h2 id="tasks-accumulating-in-queue">Tasks accumulating in queue</h2>
<p>If no tasks are getting evaluated, here are a few things to check :</p>
<ul>
<li>Which state are the servers in? Check the section below for more information.</li>
<li>Check the log, a task could be causing issues; the log will contain the ID of the task and the server causing issues</li>
<li>Remove the first tasks in the table <code>queue</code> and see if it unblocks the queue</li>
</ul>
<h2 id="servers">Servers</h2>
<p>The servers can be in multiple statuses :</p>
<ul>
<li><code>busy</code> : the server is currently evaluating one or more tasks. If the server doesn't return results after the timeout (default is 5 minutes), the graderqueue will send the task to another server</li>
<li><code>polling</code> : the server just connected to the graderqueue, and is waiting for a task but didn't get one yet</li>
<li><code>sleeping</code> : the server is waiting for the graderqueue to wake it up; it is currently idle. Note that if a server is <code>sleeping</code> while there are tasks for it, for less than 10 minutes, it may mean the server is waiting for its health to regenerate (for instance, when an EC2 server is out of credits).</li>
</ul>
<p>Some commands to help :</p>
<ul>
<li><code>systemctl status graderserver</code> will show the last log lines of the graderserver; it will typically show what the server is doing</li>
<li><code>systemctl restart graderserver</code> will restart the graderserver; it may take a few seconds if the graderserver is currently evaluating a task, but a timeout will kill it to restart it if it takes too long</li>
</ul>
<p>Some logs to look at (on France-ioi's installation) :</p>
<ul>
<li><code>/var/log/graderserver.log</code> : graderserver log</li>
<li><code>/home/grader/taskgrader/taskgrader.log</code> : taskgrader log</li>
</ul>
<p>These logs will generally contain some more information about :</p>
<ul>
<li>whether the server is receiving tasks to evaluate (and their ID)</li>
<li>whether it manages to fetch the task data from the repository</li>
<li>whether it manages to execute the taskgrader for evaluating the task</li>
<li>whether the taskgrader evaluated successfully</li>
<li>some basic results about the task</li>
</ul></div>
            
        </div>

        <footer class="col-md-12">
            <hr>
            
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>

        <script src="../js/jquery-1.10.2.min.js"></script>
        <script src="../js/bootstrap-3.0.3.min.js"></script>
        <script src="../js/highlight.pack.js"></script>
        <script>var base_url = '..';</script>
        <script data-main="../mkdocs/js/search.js" src="../mkdocs/js/require.js"></script>
        <script src="../js/base.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                        <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                    </div>
                    <div class="modal-body">
                        <p>
                            From here you can search these documents. Enter
                            your search terms below.
                        </p>
                        <form role="form">
                            <div class="form-group">
                                <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                            </div>
                        </form>
                        <div id="mkdocs-search-results"></div>
                    </div>
                    <div class="modal-footer">
                    </div>
                </div>
            </div>
        </div>

    </body>
</html>
